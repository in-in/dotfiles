---
- name: global config | find all roles
  find:
    file_type: directory
    paths: '{{ dotfiles_roles }}'
  register: find_result

- name: global config | collect stat
  import_tasks: '{{ helper_path }}/stat.yml'
  vars:
    path: '{{ dotfiles_roles }}/{{ item.path | basename }}/defaults/main.yml'
    data: '{{ find_result.files | sort(attribute="path") }}'

- name: global config | include vars
  include_vars:
    file: '{{ item.stat.path }}'
    name: 'global_config_{{ item.item.path | basename }}'
  when: item.stat.exists
  loop: '{{ helper_stat_result.results }}'
