---
- name: create directory
  file:
    path: '{{ item.dest }}'
    state: directory
  when: item.dest is not directory
  loop: '{{ template_list }}'

- name: create template
  become: '{{ item.privilege | default(false) }}'
  template:
    src: '{{ item.src }}.j2'
    dest: '{{ item.dest }}/{{ item.src }}'
    lstrip_blocks: yes
    backup: yes
  vars:
    data: '{{ item.data | default(None) }}'
  loop: '{{ template_list }}'
