---
- name: create task variable
  set_fact:
    prebuilt_themes: |
      {{
        prebuilt_themes
        | default([])
        + [ gnome_terminal_prebuilt_theme ]
      }}
  loop: '{{ gnome_terminal_themes }}'

- name: run dconf helper
  import_tasks: '{{ helpers }}/dconf.yml'
  vars:
    dconf_facts:
      - key: '/org/gnome/terminal/legacy/confirm-close'
        value: 'false'
      - key: '/org/gnome/terminal/legacy/default-show-menubar'
        value: 'false'
        # set all themes
      - '{{ prebuilt_themes }}'
        # set all new profiles list
      - key: '/org/gnome/terminal/legacy/profiles:/list'
        value: |
          {{
            gnome_terminal_themes
            | map(attribute='name')
            | map('to_uuid')
            | list
          }}
        # set default theme
      - key: '/org/gnome/terminal/legacy/profiles:/default'
        value: "'{{ gnome_terminal_default_theme | to_uuid }}'"
