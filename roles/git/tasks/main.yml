---
- name: run repo helper
  import_tasks: '{{ helper_path }}/repo.yml'
  vars:
    repo_list:
      - repo: 'ppa:git-core/ppa'

- name: run package helper
  import_tasks: '{{ helper_path }}/package_apt.yml'

- name: run template helper
  import_tasks: '{{ helper_path }}/template.yml'
  vars:
    template_list:
      - src: '.gitignore'
        dest: '{{ dotfiles_directory }}'

- name: git config
  block:
    - name: git config | with vault password
      git_config:
        name: '{{ item.name }}'
        value: '{{ item.value }}'
        scope: '{{ item.scope | default("global") }}'
        repo: '{{ item.repo | default(None) }}'
      loop: '{{ git_config_data }}'
  rescue:
    - name: git config | without vault password
      debug:
        msg: 'Create your own git config yourself'
